import { Notes, Head, Steps } from "mdx-deck";
import { CodeSurferLayout, vsDarkPartial } from "code-surfer";
import { Meta, Profile, AlignLeft, Header, Mermaid } from "./parts";
import "main.css";

export const theme = vsDarkPartial;

<Head>
  <Meta
    title="CDKã®ã‚³ãƒ¼ãƒ‰ã®èª­ã¿æ–¹(ä»®)"
    description="CDKã®ã‚³ãƒ¼ãƒ‰ã®èª­ã¿æ–¹(ä»®)"
    publishedAt={"2022-03-31T15:00:51.470Z"}
    host="https://yamatatsu.github.io/slide-aws-cdk-conference-japan"
  />
</Head>


# CDK ã®ã‚³ãƒ¼ãƒ‰ã®èª­ã¿æ–¹(ä»®)

[AWS CDK Conference Japan](https://jawsug.connpass.com/event/240422/)

@yamatatsu

---

<AlignLeft>

<Header>About Me</Header>

<Profile />

</AlignLeft>

---

### IoTå‘¨ã‚Šã®CDKã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™

- aws-iot
- aws-iotevents (Now)
- aws-wafv2 (äºˆå®š)

---

<CodeSurferLayout>

```ts
import * as iot from 'aws-cdk-lib/aws-iot';

const firehoseActionRole = new iam.Role(this, 'firehoseActionRole', {
  assumedBy: new iam.ServicePrincipal('iot.amazonaws.com'),
});
stream.grantPutRecords(firehoseActionRole);

const s3ActionRole = new iam.Role(this, 's3ActionRole', {
  assumedBy: new iam.ServicePrincipal('iot.amazonaws.com'),
});
bucket.grantPut(s3ActionRole);

new iot.CfnTopicRule(this, 'MyTopicRule' {
  topicRulePayload: {
    sql: "SELECT * FROM 'things/+/data'",
    actions: [
      {
        lambda: {
          functionArn: func.functionArn,
        },
      },
      {
        firehose: {
          deliveryStreamName: stream.deliveryStreamName,
          roleArn: firehoseActionRole.roleArn,
        },
      },
    ],
    errorAction: {
      s3: {
        bucketName: bucket.bucketName,
        key: 'key',
        roleArn: s3ActionRole.roleArn,
      },
    },
  },
});
```

```ts 1
import * as iot from 'aws-cdk-lib/aws-iot';

const firehoseActionRole = new iam.Role(this, 'firehoseActionRole', {
  assumedBy: new iam.ServicePrincipal('iot.amazonaws.com'),
});
stream.grantPutRecords(firehoseActionRole);

const s3ActionRole = new iam.Role(this, 's3ActionRole', {
  assumedBy: new iam.ServicePrincipal('iot.amazonaws.com'),
});
bucket.grantPut(s3ActionRole);

new iot.CfnTopicRule(this, 'MyTopicRule' {
  topicRulePayload: {
    sql: "SELECT * FROM 'things/+/data'",
    actions: [
      {
        lambda: {
          functionArn: func.functionArn,
        },
      },
      {
        firehose: {
          deliveryStreamName: stream.deliveryStreamName,
          roleArn: firehoseActionRole.roleArn,
        },
      },
    ],
    errorAction: {
      s3: {
        bucketName: bucket.bucketName,
        key: 'key',
        roleArn: s3ActionRole.roleArn,
      },
    },
  },
});
```

```ts
import * as iot from '@aws-cdk/aws-iot-alpha';
import * as actions from '@aws-cdk/aws-iot-actions-alpha';

const firehoseActionRole = new iam.Role(this, 'firehoseActionRole', {
  assumedBy: new iam.ServicePrincipal('iot.amazonaws.com'),
});
stream.grantPutRecords(firehoseActionRole);

const s3ActionRole = new iam.Role(this, 's3ActionRole', {
  assumedBy: new iam.ServicePrincipal('iot.amazonaws.com'),
});
bucket.grantPut(s3ActionRole);

new iot.CfnTopicRule(this, 'MyTopicRule' {
  topicRulePayload: {
    sql: "SELECT * FROM 'things/+/data'",
    actions: [
      {
        lambda: {
          functionArn: func.functionArn,
        },
      },
      {
        firehose: {
          deliveryStreamName: stream.deliveryStreamName,
          roleArn: firehoseActionRole.roleArn,
        },
      },
    ],
    errorAction: {
      s3: {
        bucketName: bucket.bucketName,
        key: 'key',
        roleArn: s3ActionRole.roleArn,
      },
    },
  },
});
```

```ts 4:12
import * as iot from '@aws-cdk/aws-iot-alpha';
import * as actions from '@aws-cdk/aws-iot-actions-alpha';

const firehoseActionRole = new iam.Role(this, 'firehoseActionRole', {
  assumedBy: new iam.ServicePrincipal('iot.amazonaws.com'),
});
stream.grantPutRecords(firehoseActionRole);

const s3ActionRole = new iam.Role(this, 's3ActionRole', {
  assumedBy: new iam.ServicePrincipal('iot.amazonaws.com'),
});
bucket.grantPut(s3ActionRole);

new iot.CfnTopicRule(this, 'MyTopicRule' {
  topicRulePayload: {
    sql: "SELECT * FROM 'things/+/data'",
    actions: [
      {
        lambda: {
          functionArn: func.functionArn,
        },
      },
      {
        firehose: {
          deliveryStreamName: stream.deliveryStreamName,
          roleArn: firehoseActionRole.roleArn,
        },
      },
    ],
    errorAction: {
      s3: {
        bucketName: bucket.bucketName,
        key: 'key',
        roleArn: s3ActionRole.roleArn,
      },
    },
  },
});
```

```ts
import * as iot from '@aws-cdk/aws-iot-alpha';
import * as actions from '@aws-cdk/aws-iot-actions-alpha';

new iot.CfnTopicRule(this, 'MyTopicRule' {
  topicRulePayload: {
    sql: "SELECT * FROM 'things/+/data'",
    actions: [
      {
        lambda: {
          functionArn: func.functionArn,
        },
      },
      {
        firehose: {
          deliveryStreamName: stream.deliveryStreamName,
          roleArn: firehoseActionRole.roleArn,
        },
      },
    ],
    errorAction: {
      s3: {
        bucketName: bucket.bucketName,
        key: 'key',
        roleArn: s3ActionRole.roleArn,
      },
    },
  },
});
```


```ts 4:28
import * as iot from '@aws-cdk/aws-iot-alpha';
import * as actions from '@aws-cdk/aws-iot-actions-alpha';

new iot.CfnTopicRule(this, 'MyTopicRule' {
  topicRulePayload: {
    sql: "SELECT * FROM 'things/+/data'",
    actions: [
      {
        lambda: {
          functionArn: func.functionArn,
        },
      },
      {
        firehose: {
          deliveryStreamName: stream.deliveryStreamName,
          roleArn: firehoseActionRole.roleArn,
        },
      },
    ],
    errorAction: {
      s3: {
        bucketName: bucket.bucketName,
        key: 'key',
        roleArn: s3ActionRole.roleArn,
      },
    },
  },
});
```

```ts
import * as iot from '@aws-cdk/aws-iot-alpha';
import * as actions from '@aws-cdk/aws-iot-actions-alpha';

new iot.TopicRule(this, 'MyTopicRule' {
  sql: iot.IotSql.fromStringAsVer20160323("SELECT * FROM 'things/+/data'"),
  actions: [
    new actions.FirehoseStreamAction(stream),
    new actions.LambdaFunctionAction(func),
  ],
  errorAction: new actions.S3PutObjectAction(bucket)
});
```

```ts 1:11
import * as iot from '@aws-cdk/aws-iot-alpha';
import * as actions from '@aws-cdk/aws-iot-actions-alpha';

new iot.TopicRule(this, 'MyTopicRule' {
  sql: iot.IotSql.fromStringAsVer20160323("SELECT * FROM 'things/+/data'"),
  actions: [
    new actions.FirehoseStreamAction(stream),
    new actions.LambdaFunctionAction(func),
  ],
  errorAction: new actions.S3PutObjectAction(bucket)
});
```

</CodeSurferLayout>

---

<AlignLeft>

<Header>æ¦‚è¦</Header>

1. CDK ã®ã‚³ãƒ¼ãƒ‰ã®ä¸­
1. ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆã«å‘ã‘ã¦
1. ãŠã‚ã‚Šã«

</AlignLeft>

---

## ãã®ã¾ãˆã«

---

## ã‚´ãƒ¼ãƒ«ã®å…±æœ‰

---

<Header>ã‚´ãƒ¼ãƒ«</Header>

### ğŸ˜© â†’ ğŸ¤©

---

<Header>ã‚´ãƒ¼ãƒ«</Header>

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒè¶³ã‚Šãªã„ã€‚

### ğŸ˜© ãã¬ã¬

---

<Header>ã‚´ãƒ¼ãƒ«</Header>

### ã‚³ãƒ¼ãƒ‰èª­ã‚ã°ã„ã„ã‚„

### ğŸ˜‡

---

<Header>ã‚´ãƒ¼ãƒ«</Header>

### Props ã®å±æ€§ãŒè¶³ã‚Šãªã„ã€‚æ©Ÿèƒ½ãŒè¶³ã‚Šãªã„ã€‚

### ğŸ˜© ãã¬ã¬

---

<Header>ã‚´ãƒ¼ãƒ«</Header>

### ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ£ãƒ³ã‚¹ï¼

### ğŸ¤©

---

<Header>ã‚´ãƒ¼ãƒ«</Header>

# ğŸ˜© â†’ ğŸ¤©

---

<img src={require("file-loader!./parts/assets/race-chart.png")} width="1000" />

https://yamatatsu.github.io/aws-cdk-contribution-chart/

---

## ã§ã¯ã•ã£ãã

---

## CDK ã®ã‚³ãƒ¼ãƒ‰ã®ä¸­

---

ã®ã¾ãˆã«

---

## CDK ã®äºˆå‚™çŸ¥è­˜

---

<Header>CDK ã®äºˆå‚™çŸ¥è­˜</Header>

- **[jsii](https://github.com/aws/jsii)**: CDK ã¯TypeScriptã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ä»–è¨€èªã¨Docã¨ã‚’  
  è‡ªå‹•ç”Ÿæˆã—ã¦ã„ã‚‹
- **[L1, L2, L3](https://docs.aws.amazon.com/cdk/v2/guide/constructs.html#constructs_lib)**:
  - **L1**: AWS CloudFormation ã®å®šç¾©ã‹ã‚‰è‡ªå‹•ç”Ÿæˆ
  - **L2**: L1 ã‚’ãƒ©ãƒƒãƒ—ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å„ªã—ãã—ãŸã‚¯ãƒ©ã‚¹
  - **L3**: L2 ã‚’çµ„ã¿åˆã‚ã›ã¦ç‰¹å®šãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«ç‰¹åŒ–  
    (ecs-patterns ãªã©)

---

## ã§ã¯

---

<Header>CDK ã®ã‚³ãƒ¼ãƒ‰ã®ä¸­</Header>

`aws-lambda/lib/function.ts`  
ã®ä¸­ã‚’è¦‹ã¦ã¿ã‚ˆã† :eyes:

---

<CodeSurferLayout>

```ts subtitle="ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯Functionã‚¯ãƒ©ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™"
export class Function extends cdk.Resource {
}
```

```ts 1[31:43] subtitle="Resourceã¯AWSãƒªã‚½ãƒ¼ã‚¹ã‚’æŠ½è±¡ã™ã‚‹ã‚¯ãƒ©ã‚¹ã§ã™"
export class Function extends cdk.Resource {
}
```

```ts subtitle="ã‚¯ãƒ©ã‚¹ã«ã¯constructorãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™"
export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {
  }
}
```

```ts 2[52:65] subtitle="3ã¤ã‚ã«ã¯ã‚¯ãƒ©ã‚¹ã”ã¨ã«ç‹¬è‡ªã®Propså‹ã‚’ã¨ã‚Šã¾ã™"
export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {
  }
}
```

```ts subtitle="ã»ã¨ã‚“ã©ã®å ´åˆã€åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«å†…ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™"
export interface FunctionProps {
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {
  }
}
```

```ts subtitle="ãŠãªã˜ã¿ã®codeã‚‚ã“ã“ã§å®šç¾©ã•ã‚Œã¦ã„ã¾ã™"
export interface FunctionProps {
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {
  }
}
```

```ts subtitle="Propsã®å±æ€§ã«ã¯å¿…ãšjsdocãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {
  }
}
```

```ts 2:6 subtitle="ã¡ãªã¿ã«jsdocãŒãªã„ã¨CIãŒè½ã¡ã‚‹ã®ã§ã»ã¼å¿…ãšjsdocãŒã‚ã‚Šã¾ã™ğŸ˜…"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {
  }
}
```

```ts 2:6 subtitle="ã¨ãã©ãè¨˜è¼‰å†…å®¹ãŒé–“é•ã£ã¦ãŸã‚Šã—ã¾ã™"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {
  }
}
```

```ts 2:6 subtitle="ãƒãƒ£ãƒ³ã‚¹ã§ã™ğŸ¤©"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {
  }
}
```

```ts subtitle="propsã¯constructorã®ä¸­ã§ä½¿ã‚ã‚Œã¾ã™"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
    });
  }
}
```

```ts 15:23 subtitle="constructorã®ä¸­ã«ã¯Cfnxxxã¨ã„ã†ã‚¯ãƒ©ã‚¹ãŒä½¿ã‚ã‚Œã¦ã„ã¾ã™"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
    });
  }
}
```

```ts 15:23 subtitle="ã“ã‚Œã¯L1ã‚¯ãƒ©ã‚¹ã¨å‘¼ã°ã‚Œã€CloudFormationã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ãã®ã¾ã¾å®Ÿè£…ã—ãŸã‚¯ãƒ©ã‚¹ã§ã™"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
    });
  }
}
```

```ts 15:23 subtitle="ãªã®ã§CloudFormationã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã‚ã°ä½¿ã„æ–¹ãŒã‚ã‹ã‚Šã¾ã™"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
    });
  }
}
```

```ts 1:25 subtitle="ã“ã‚Œã¯ã‹ãªã‚Šå˜ç´”åŒ–ã—ãŸã‚³ãƒ¼ãƒ‰ã§ã¯ã‚ã‚Šã¾ã™ãŒã€åŸºæœ¬çš„ã«ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
    });
  }
}
```

```ts 1:25 subtitle="å…¥åŠ›(Props)ã¨å‡ºåŠ›(Cfn)ã®ä»•çµ„ã¿ãŒåˆ†ã‹ã‚‹ã¨ã€èª­ã‚ã‚‹æ°—ãŒã—ã¦ãã¾ã›ã‚“ã‹ï¼Ÿ"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
    });
  }
}
```

```ts 1:25 subtitle="ãã‚Œã§ã¯ã“ã®ã‚¯ãƒ©ã‚¹ã«handlerã‚’è¿½åŠ ã™ã‚‹æ©Ÿèƒ½è¿½åŠ ã—ã¦ã¿ã¾ã—ã‚‡ã†"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
    });
  }
}
```

```ts subtitle="ã¾ãšã¯CloudFormationã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å¾“ã£ã¦handlerã‚’L1ã‚¯ãƒ©ã‚¹ã«æ¸¡ã—ã¾ã™"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
      handler: props.handler,
    });
  }
}
```

```ts subtitle="æ¬¡ã«ã€Propsã«handlerã‚’ç”Ÿã‚„ã—ã¦ã‚ã’ã¾ã™"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;

  readonly handler: string;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
      handler: props.handler,
    });
  }
}
```

```ts subtitle="æœ€å¾Œã«ã€CloudFormationã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãªã©ã‚’å‚è€ƒã«jsdocã‚’æ›¸ãã¾ã™"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;

  /**
   * The name of the method within your code that Lambda calls to execute
   * your function. The format includes the file name. It can also include
   * namespaces and other qualifiers, depending on the runtime.
   */
  readonly handler: string;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
      handler: props.handler,
    });
  }
}
```

```ts 1:30 subtitle="ã‚ã¨ã¯ãƒ†ã‚¹ãƒˆã¨READMEã‚’è¿½è¨˜ã™ã‚Œã°PRã‚’å‡ºã›ã¾ã™ï¼"
export interface FunctionProps {
  /**
   * The source code of your Lambda function. You can point to a file in an
   * Amazon Simple Storage Service (Amazon S3) bucket or specify your source
   * code as inline text.
   */
  readonly code: Code;

  /**
   * The name of the method within your code that Lambda calls to execute
   * your function. The format includes the file name. It can also include
   * namespaces and other qualifiers, depending on the runtime.
   */
  readonly handler: string;
}

export class Function extends cdk.Resource {
  constructor(scope: Construct, id: string, props: FunctionProps) {

    const code = props.code;

    const resource = new CfnFunction(this, 'Resource', {
      code: {
        s3Bucket: code.s3Location && code.s3Location.bucketName,
        s3Key: code.s3Location && code.s3Location.objectKey,
        s3ObjectVersion: code.s3Location && code.s3Location.objectVersion,
        zipFile: code.inlineCode,
        imageUri: code.image?.imageUri,
      },
      handler: props.handler,
    });
  }
}
```

</CodeSurferLayout>

---

## ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆã«å‘ã‘ã¦

---

<Header>ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆã«å‘ã‘ã¦</Header>

- Unit Testã‚’æ›¸ã
- Integ Testã‚’æ›¸ã
- READMEã‚’æ›¸ã
- PRã‚’ä½œã‚‹
- CIã‚’é€šã™

---

<Header>ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆã«å‘ã‘ã¦</Header>

- ~~Unit Testã‚’æ›¸ã~~
- ~~Integ Testã‚’æ›¸ã~~
- ~~READMEã‚’æ›¸ã~~
- ~~PRã‚’ä½œã‚‹~~
- ~~CIã‚’é€šã™~~

---

ãƒ–ãƒ­ã‚°ã§æ›¸ãã‚

---

# ğŸ¤©

---

<img src={require("file-loader!./parts/assets/pulumi-vs-cdk.png")} width="800" />

https://www.pulumi.com/docs/intro/vs/cloud-template-transpilers/

---

<img src={require("file-loader!./parts/assets/pulumi-vs-cdk-answer.png")} width="1000" />

https://github.com/pulumi/pulumi-hugo/issues/1275

---

ã§ã‚‚ãªãã€‚ã€‚ã€‚

---

CFnã¯Stackã®ä¸­ã®ãƒªã‚½ãƒ¼ã‚¹ãŸã¡ã‚’åŠ¹ç‡çš„ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãã‚Œã‚‹ã‘ã©ã€CDKã¯ãã®Stackã‚’ç›´åˆ—ã§ã—ã‹ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãã‚Œãªã„ã‚“ã ã‚ˆãªãã€‚ã€‚ã€‚

CDãŒæ™‚é–“ã‹ã‹ã‚‹ã‚“ã ã‚ˆãªãã€‚ã€‚ã€‚

---

<img src={require("file-loader!./parts/assets/concurrent.png")} width="1000" />

https://github.com/aws/aws-cdk/pull/19378

---

ã§ã‚‚ãªãã€‚ã€‚ã€‚

---

terraformã¯æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã®å–ã‚Šè¾¼ã¿ãŒã‚ã£ã¡ã‚ƒå¼·ã„ã‚“ã ã‚ˆãªãã€‚ã€‚ã€‚

---

<img src={require("file-loader!./parts/assets/import.png")} width="1000" />

https://github.com/aws/aws-cdk/pull/17666

---

## ãŠã‚ã‚Šã«

---

<Header>ãŠã‚ã‚Šã«</Header>

<div style={{margin: '0 100px'}}>

- ä»Šå›ã®ã‚³ãƒ¼ãƒ‰ã¯å®Ÿç‰©ã‚’ã‹ãªã‚Šå˜ç´”åŒ–ã—ãŸã‚‚ã®ã§ã™ãŒã€åŸºæœ¬çš„ãªèª­ã¿æ–¹ã«å¤‰ã‚ã‚Šã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

  ï¼ˆä¾‹å¤–: CLIã€Custom Resourceã€Assetsãªã©ï¼‰

- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä¸å‚™ã‚„ã€ç”Ÿãˆã¦ãªã„æ©Ÿèƒ½ã‚’è¦‹ã¤ã‘ãŸã‚‰ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆã—ã¦ã¿ã¦ã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ

</div>

---

ã”æ¸…æ¾„ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ :pray:
